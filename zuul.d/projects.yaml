# Shared zuul config specific to the OpenStack Project
# Contains project pipeline definitions

# This project definition is here so that the only zuul config in
# zuul-jobs are the jobs themselves (to make it easy for other users
# to consume).
- project:
    name: openstack-infra/zuul-jobs
    templates:
      - publish-openstack-python-docs-infra
    check:
      jobs:
        - base-integration-centos-7
        - base-integration-debian-jessie
        - base-integration-fedora-26
        - base-integration-ubuntu-trusty
        - base-integration-ubuntu-xenial
        - base-integration-opensuse423
        - tox-linters
        - tox-py35-on-zuul
    gate:
      jobs:
        - base-integration-centos-7
        - base-integration-debian-jessie
        - base-integration-fedora-26
        - base-integration-ubuntu-trusty
        - base-integration-ubuntu-xenial
        - base-integration-opensuse423
        - tox-linters
        - tox-py35-on-zuul

- project:
    name: openstack-dev/sandbox
    release:
      jobs:
        - release-openstack-python

- project:
    name: openstack/requirements
    periodic:
      jobs:
        # This is a periodic job to ensure that our wheels are reasonably
        # up-to-date. It uses the upper-constraints files from requirements.
        - build-wheel-mirror
        - release-wheel-mirror:
            dependencies:
              - build-wheel-mirror

- project:
    name: openstack-infra/project-config
    templates:
      - bindep-fallback
      - merge-check
    check:
      jobs:
        - build-openstack-specs-site
        - openstack-tox-linters:
            files:
              - ^.*\.sh$
              - ^.*\.py$
              - bindep.txt
              - other-requirements.txt
              - test-requirements.txt
              - tox.ini
        - project-config-dib
        - project-config-gerrit
        - project-config-grafyaml
        - project-config-infra-docs-index
        - project-config-irc-access
        - project-config-nodepool
        - zuul-migrate:
            files:
              - zuul/mapping.yaml
    gate:
      queue: project-config
      jobs:
        - build-openstack-specs-site
        - openstack-tox-linters:
            files:
              - ^.*\.sh$
              - ^.*\.py$
              - bindep.txt
              - other-requirements.txt
              - test-requirements.txt
              - tox.ini
        - project-config-dib
        - project-config-gerrit
        - project-config-grafyaml
        - project-config-infra-docs-index
        - project-config-irc-access
        - project-config-nodepool
    post:
      jobs:
        - publish-openstack-python-docs-infra-index
        - publish-openstack-specs-site
    periodic:
      jobs:
        - propose-project-config-update
        - project-config-build-openafs-centos
